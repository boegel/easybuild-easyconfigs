easyblock = 'CMakeMake'

name = 'intel-graphics-compiler'
version = '1.0.4155'

homepage = 'https://github.com/intel/gmmlib'
description = """The Intel(R) Graphics Memory Management Library provides device specific and buffer management
 for the Intel(R) Graphics Compute Runtime for OpenCL(TM) and the Intel(R) Media Driver for VAAPI."""

toolchain = {'name': 'GCCcore', 'version': '9.3.0'}

source_urls = ['https://github.com/intel/intel-graphics-compiler/archive/']
sources = ['igc-%(version)s.tar.gz']
checksums = ['d5ac4dce02c36be1d15dfc253224bfc47eaf7538b5563a492fd3e4658649f78e']

builddependencies = [
    ('binutils', '2.34'),
    ('flex', '2.6.4'),
    ('Bison', '3.5.3'),
    ('CMake', '3.16.4'),
    ('zlib', '1.2.11'),
    ('Clang', '10.0.0'),
    ('opencl-clang', '10.0.0-2'),
]

configopts = '-DIGC_PREFERRED_LLVM_VERSION="$EBVERSIONCLANG"'

sanity_check_paths = {
    'files': ['bin/GenX_IR', 'bin/iga64', 'lib64/libiga64.%s' % SHLIB_EXT,
              'lib64/libigc.%s' % SHLIB_EXT, 'lib64/libigdfcl.%s' % SHLIB_EXT],
    'dirs': ['include/iga', 'include/igc', 'include/visa', 'lib64/pkgconfig'],
}

moduleclass = 'lib'
